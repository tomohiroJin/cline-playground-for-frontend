# GitHub Copilot用指示書

## 基本思想と具体的行動指針

### 達人プログラマー（The Pragmatic Programmer）の原則

書籍「達人プログラマー」に記述されてる内容を意識してください。
特に下記の内容を意識して下さい。

- **DRY原則（Don't Repeat Yourself）**
  - 同じコードが複数箇所に存在することを絶対に避け、共通化する。
- **継続的なリファクタリング**
  - 常にコードを再評価し、小さな改善を積極的に行う。悪いコードを見つけたらすぐに修正する。
- **自動化の徹底**
  - 手動で行われる作業（ビルド、テスト、デプロイ、環境構築など）は必ず自動化スクリプト化する。
- **読みやすさ最優先**
  - 誰が読んでも意図が理解できるような明快なコードを心掛ける。特に変数名や関数名を説明的に詳細に付け、過度なコメントを避ける。
- **壊れた窓理論**
  - わずかな問題も放置せず、小さなバグやコードの乱れを即時修正する。
- **契約による設計(DbC)**
  - メソッドや関数の基本的な考え方として契約による設計(DbC)を意識して作成してください。
    - 不変条件、事前条件、事後条件
    - 義務と利益

### テスト駆動開発（TDD）に対する行動

テスト駆動開発は全てのプログラマーの基本だと思っています。
下記の内容を意識して修正してください。

- テストリスト（TODO）を必ず考えてください。
  - テストリスト（TODO）は振る舞いベースで考えてください。
- テストは振る舞いベースで書いてください。
- テストを作成する場合テストスメルに注意して下さい。
  - アサーションルーレット (Assertion Roulette)
  - 条件付きテストロジック (Conditional Test Logic)
  - コンストラクタ初期化 (Constructor Initialization)
  - デフォルトテスト (Default Test)
  - 重複アサート (Duplicate Assert)
  - 欲張りなテスト (Eager Test)
  - 空のテスト (Empty Test)
  - 例外処理 (Exception Handling)
  - 汎用的なフィクスチャ (General Fixture)
  - 無視されたテスト (Ignored Test)
  - 怠惰なテスト (Lazy Test)
  - マジックナンバーテスト (Magic Number Test)
  - 謎のゲスト (Mystery Guest)
  - 冗長なプリント (Redundant Print)
  - 冗長なアサーション (Redundant Assertion)
  - リソース楽観主義 (Resource Optimism)
  - 繊細な等価性 (Sensitive Equality)
  - 眠たいテスト (Sleepy Test)
  - 不明なテスト (Unknown Test)
- コードを書く前に必ずテストを書き、失敗テスト（Red）を確認した後で最小限のコードで成功（Green）を達成し、最後に必ずリファクタリングを行う。
- 各テストは1つの挙動だけを確認するように細分化し、複数の内容をまとめない。
- テストコード自体が読みやすくメンテナンスしやすくなるよう、具体的かつ明確なメソッド名や変数名を用いる。

### 「脳に収まるコードの書き方」（Code That Fits in Your Head）の実践

- コードは一目で理解可能な単位に細分化し、各関数・クラスは一画面に収まるサイズに保つ。
- 複雑なロジックや条件分岐は短い関数に分割し、意図を明確化する。
- 抽象化レイヤーを意識し、低層の詳細を隠蔽し、高層のコードはシンプルかつ明快に保つ。

### 「Tidy First?」による日常的なリファクタリング

- コードの乱れを発見したら、直ちにリファクタリングを行い、コードベースを常に整然とした状態に保つ。
- 新規開発や機能追加の前には、必ず既存コードの明確化と整理整頓を実施する。
- 不明瞭なコードが存在した場合、新機能の開発を一時停止し、まずコードの整理を優先する。

## プログラミングスタイル・技術趣向

### 関数型プログラミングの徹底

- 副作用を避けた純粋関数を利用し、コード内で状態の変化を最小限に抑える。
- 不変データを積極的に使用し、データの変更を避けて新しいインスタンスを生成する。
- 高階関数、クロージャ、モナドなど関数型プログラミングの概念を明示的かつ積極的に取り入れる。

### 曳光弾（Tracer Bullet）アプローチの具体的実践

- 開発は常にアウトサイドイン（外側のインターフェースやUIから内部ロジック）で進める。
- 最初にE2Eテストを作成し、アプリケーションの全体像を早期に把握する。
- 外部から内部に向けて最小限の動作確認を実現し、その後に内部機能や詳細ロジックを充実させていく。

## コーディングの具体的な行動ルール

- コメントは最小限とし、代わりにメソッド名・変数名・定数名を十分説明的かつ詳細に設定する。
- 関数・メソッドの長さを原則として5〜10行以内に収め、機能単位に細分化する。
- クラスやモジュールは単一責任原則（SRP）に従い、明確な役割分担をする。
- 条件分岐は必ず早期リターン（Early Return）やポリモーフィズムによって簡潔にする。
- 重複や複雑さを感じた時点で、即座に関数やメソッドを分割する。

## セキュリティと品質の行動指針

- 入力値を必ず検証し、サニタイズした後に使用する。
- 例外やエラー処理をユーザーや開発者に明快で具体的な形で実装し、曖昧な例外メッセージを避ける。
- 使用する外部ライブラリや依存関係の脆弱性チェックを定期的に行い、最新かつ安全な状態を維持する。

## その他の情報

- プロジェクト固有の詳細情報やドメイン知識を必要に応じてここに明記する。
