# LABYRINTH OF SHADOWS ブラッシュアップ計画

## 概要

LABYRINTH OF SHADOWS の4フェーズブラッシュアップ。パフォーマンス改善、ゲームプレイ強化、演出強化、追加コンテンツの順で実施。

## ブランチ戦略

- ブランチ名: `feature/los-brushup`
- main ブランチから分岐
- 各フェーズ完了時にテスト・ビルド確認

## Phase 1: 基盤整備

### 目的
パフォーマンスの改善と基本機能の追加。

### タスク
1. **パフォーマンス最適化** — `setHud`/`setMapData` を毎フレーム呼び出す代わりに、値の変化を検知して必要な場合のみ更新
2. **Minimap Canvas化** — DOM ベースの Minimap を Canvas 描画に変更（`minimap-renderer.ts` 新規作成）
3. **ポーズ機能** — Escape キーでゲームを一時停止/再開。ポーズ中はゲームループを停止
4. **README 修正** — 操作説明の「Ctrl: 隠れる」を「Space: 隠れる」に修正
5. **テスト基盤** — `renderer.test.ts`、`audio.test.ts` を新規作成

### 依存関係
- Minimap Canvas化 → パフォーマンス最適化完了後
- ポーズ機能は独立

### リスク
- Canvas Minimap の描画品質がDOM版と同等であること

## Phase 2: ゲームプレイ強化

### 目的
アイテム・敵の種類を増やしてゲームプレイの幅を広げる。

### タスク
1. **敵AI改善** — BFS パスファインディングを導入。壁に引っかかりにくくなる
2. **アイテム種類追加** — 回復薬💊、加速⚡、地図🗺️ の3種類
3. **敵種類追加** — 徘徊型👻、追跡型👹（既存強化）、テレポート型🌀

### 依存関係
- 敵AI改善 → Phase 1 完了後
- アイテム追加と敵追加は並行可能

### リスク
- BFS のパフォーマンス（キャッシュで対応）
- ゲームバランスの調整

## Phase 3: 視覚・聴覚演出強化

### 目的
ゲームの臨場感と雰囲気を大幅に向上。

### タスク
1. **壁テクスチャ改善** — プロシージャルなレンガパターンで壁を描画
2. **トーチ照明効果** — 照明の揺らぎ効果を追加
3. **BGM・環境音** — Web Audio API でプロシージャルアンビエント生成
4. **ポストプロセス効果** — スキャンライン、ビネット効果

### 依存関係
- Phase 2 のゲームプレイ変更が安定してから着手

### リスク
- ポストプロセスによるフレームレート低下

## Phase 4: 追加コンテンツ + 仕上げ

### 目的
マップバリエーションの追加と全体の仕上げ。

### タスク
1. **マップバリエーション** — Prim 法による迷路生成を追加
2. **3D音響** — `StereoPannerNode` で左右の音像定位
3. **ストーリー・演出強化** — 各フェーズ間のテキスト・演出
4. **テスト拡充** — 新機能のテストカバレッジ確保

### 依存関係
- Phase 3 完了後

### リスク
- Web Audio API のブラウザ互換性
