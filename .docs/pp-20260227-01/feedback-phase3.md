# Phase 3 フィードバック — ランダムイベントシステム

## 概要

Phase 3（ランダムイベントシステム）実装完了後、実際にプレイしたユーザーから受領した4項目のフィードバック。
各項目に優先度・理由・対応方針を付記する。

---

## フィードバック項目

### FB-P3-1: イベント結果のフィードバックが無い

- **優先度**: 🔴 すぐに対応
- **理由**: 選択肢を選んだ後、何が起きたか一切表示されずに進化選択画面へ遷移してしまう。プレイヤーはイベントの効果を実感できない。UX として致命的
- **現状の問題**:
  - `CHOOSE_EVENT` ハンドラで `applyEventChoice` → 即座に `phase: 'evo'` へ遷移
  - 効果の結果（HP回復量、ATK上昇値、ダメージ量など）を表示する画面・演出が無い
- **対応範囲**:
  - イベント選択後に結果オーバーレイを表示（例: `showOverlay('💪', 'ATK +8!', 1200)`）
  - 効果タイプ別のメッセージ生成関数 `formatEventResult(effect)` を追加
  - `hooks.ts` の `CHOOSE_EVENT` で結果オーバーレイを挟んでから進化選択へ遷移
  - 代替案: EventScreen 内に結果表示フェーズを追加（選択→結果→閉じる→進化）

---

### FB-P3-2: イベント選択肢のバランスが悪い

- **優先度**: 🔴 すぐに対応
- **理由**: 片方しか選ぶ理由の無いイベントが複数存在し、選択の面白さが損なわれている
- **バランス問題の分析**:

  | イベント | 問題 | 改善案 |
  |---------|------|--------|
  | 迷い仲間 | 「助ける」一択。「立ち去る」に何のメリットも無い | 助ける側にリスク（HP消費）を追加、立ち去る側に小さな報酬（骨+10など）を付与 |
  | 毒沼 | 25ダメージ vs 15回復で常に回復を選ぶ | 突っ切る側に報酬（ATK+5やDEF+3など）を追加して、リスク/リターンのトレードオフに |
  | 獣の巣穴 | ATK+12(dangerous) vs 何もなし。リスクが表示されるだけで実害なし | 探索にダメージリスクを追加、見なかったことにする側に小報酬を追加 |
  | 星降る夜 | HP回復40(safe) vs ランダム進化(risky)で回復がほぼ優位 | 回復量を抑えるか、ランダム進化のリスクレベルを下げる |

- **バランスが適切なイベント**:
  - 骨の商人: 骨コスト vs 報酬のトレードオフが明確
  - 古代の祠: 確実な文明レベルUP vs ランダム進化のリスク/リターン
  - 謎の化石: DEF+5 vs 骨+20 の状況依存選択
  - 古代の壁画: 3文明からの戦略的選択

- **対応範囲**:
  - `constants.ts` の `RANDOM_EVENTS` 定義を調整
  - 対応するテストの期待値を更新

---

### FB-P3-3: イベント画面の演出が寂しい

- **優先度**: 🟡 後で対応可
- **理由**: 機能は正しく動作しており、演出は追加的な改善。Phase 5（ビジュアル・サウンド強化）と合わせて実施が効率的
- **現状の問題**:
  - キャラクター表示が無くテキストのみで雰囲気が薄い
  - 選択後のプラス効果（回復、パワーアップ）やマイナス効果（ダメージ）のエフェクトが無い
- **対応範囲**:
  - EventScreen にプレイヤーキャラクタースプライト（Canvas）を追加
  - イベント種類に応じたアイコンやイラスト的演出
  - 効果適用時のエフェクト（回復=緑の光、ダメージ=赤のフラッシュ、パワーアップ=金の光など）
  - 依存: FB-P3-1（結果表示）の実装後に合わせて実施

---

### FB-P3-4: イベントの状況説明・タイトルが不足

- **優先度**: 🔴 すぐに対応
- **理由**: 小規模なUI変更で効果が大きい。現在は選択肢がいきなり表示され、何が起きているかの文脈が弱い
- **現状の問題**:
  - イベント名と説明文はあるが、選択肢の上に「何を求められているか」の一言がない
  - 選択の文脈（状況のまとめ）が不足
- **対応範囲**:
  - `RandomEventDef` に `situationText`（状況の一言: 例「どうする？」「選べ。」）を追加
  - EventScreen で選択肢の上に状況テキストを表示
  - イベント名の表示を目立たせる（アイコン追加等）

---

## 優先度まとめ

| 優先度 | 項目 | 作業規模 |
|--------|------|---------|
| 🔴 すぐに | FB-P3-1: イベント結果フィードバック | 中（hooks.ts + EventScreen 変更） |
| 🔴 すぐに | FB-P3-2: 選択肢バランス調整 | 小（constants.ts のデータ変更） |
| 🔴 すぐに | FB-P3-4: 状況説明テキスト追加 | 小（型拡張 + constants + UI変更） |
| 🟡 後で | FB-P3-3: 画面演出強化 | 大（Phase 5 統合） |

---

## 対応方針

### 即時対応（🔴）— 推奨実装順

1. **FB-P3-4**（状況説明テキスト）を最初に着手: 小規模で EventScreen のレイアウト変更と合わせやすい
2. **FB-P3-2**（バランス調整）: 定数変更のみ。テスト期待値の更新が必要
3. **FB-P3-1**（結果フィードバック）: hooks.ts の遷移ロジック変更 + 結果メッセージ生成。最も影響範囲が大きい

### 後日対応（🟡）

- **FB-P3-3**: Phase 5（ビジュアル・サウンド強化）のスプライトバリエーション・背景演出タスクと統合
