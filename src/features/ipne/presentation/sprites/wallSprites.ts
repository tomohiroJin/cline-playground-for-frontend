/**
 * 特殊壁タイプのスプライト定義
 *
 * 破壊可能壁（3段階）、通過可能壁、不可視壁の
 * 16×16 ピクセルアートスプライトをコードスプライト方式で定義する。
 */

import { SpriteDefinition } from './spriteData';

// ---------------------------------------------------------------------------
// 破壊可能壁・無傷（Breakable Wall - Intact）
// ---------------------------------------------------------------------------
// パレット:
//   0 = 透明
//   1 = #78350f（最も暗い茶色 - 目地・影）
//   2 = #92400e（暗い茶色 - レンガのベース色）
//   3 = #a16207（茶色 - レンガの明るい面）
//   4 = #d4a574（薄い茶色 - ハイライト）
//   5 = #6b7280（灰色 - ひび割れ線）
// ---------------------------------------------------------------------------

/** 破壊可能壁・無傷のパレット */
const BREAKABLE_INTACT_PALETTE = ['', '#78350f', '#92400e', '#a16207', '#d4a574', '#6b7280'];

/** 破壊可能壁・無傷のピクセルデータ（16×16） - 茶色レンガ + 小さなひび割れ */
const BREAKABLE_INTACT_PIXELS: number[][] = [
  // y=0:  目地ライン（上端）
  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  // y=1:  レンガ行 A（茶色レンガ 7px + 目地 + 7px）
  [4, 3, 3, 2, 2, 2, 3, 1, 4, 3, 3, 2, 2, 2, 3, 1],
  // y=2:  小さなひび割れ（x=5）
  [3, 3, 2, 2, 2, 5, 2, 1, 3, 3, 2, 2, 2, 2, 2, 1],
  // y=3
  [3, 2, 2, 2, 2, 2, 2, 1, 3, 2, 2, 2, 2, 2, 2, 1],
  // y=4:  目地ライン
  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  // y=5:  レンガ行 B（オフセット: 4px ずらし）
  [2, 2, 3, 1, 4, 3, 3, 2, 2, 2, 3, 1, 4, 3, 3, 2],
  // y=6
  [2, 2, 2, 1, 3, 3, 2, 2, 2, 2, 2, 1, 3, 3, 2, 2],
  // y=7:  小さなひび割れ（x=12）
  [2, 2, 2, 1, 3, 2, 2, 2, 2, 2, 2, 1, 5, 2, 2, 2],
  // y=8:  目地ライン
  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  // y=9:  レンガ行 C（行 A と同パターン）
  [4, 3, 3, 2, 2, 2, 3, 1, 4, 3, 3, 2, 2, 2, 3, 1],
  // y=10
  [3, 3, 2, 2, 2, 2, 2, 1, 3, 3, 2, 2, 2, 2, 2, 1],
  // y=11: 小さなひび割れ（x=3）
  [3, 2, 2, 5, 2, 2, 2, 1, 3, 2, 2, 2, 2, 2, 2, 1],
  // y=12: 目地ライン
  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  // y=13: レンガ行 D（行 B と同パターン）
  [2, 2, 3, 1, 4, 3, 3, 2, 2, 2, 3, 1, 4, 3, 3, 2],
  // y=14
  [2, 2, 2, 1, 3, 3, 2, 2, 2, 2, 2, 1, 3, 3, 2, 2],
  // y=15
  [2, 2, 2, 1, 3, 2, 2, 2, 2, 2, 2, 1, 3, 2, 2, 2],
];

/**
 * 破壊可能壁・無傷スプライト
 *
 * 茶色のレンガ模様の壁。通常の壁と似た構造だが、
 * 茶色のトーンと小さなひび割れで破壊可能であることを示す。
 * 構造的にはまだ健全な状態。
 */
export const BREAKABLE_INTACT_SPRITE: SpriteDefinition = {
  width: 16,
  height: 16,
  pixels: BREAKABLE_INTACT_PIXELS,
  palette: BREAKABLE_INTACT_PALETTE,
};

// ---------------------------------------------------------------------------
// 破壊可能壁・損傷（Breakable Wall - Damaged）
// ---------------------------------------------------------------------------
// パレット:
//   0 = 透明
//   1 = #78350f（最も暗い茶色 - 目地・影）
//   2 = #92400e（暗い茶色 - レンガのベース色）
//   3 = #c2410c（暗いオレンジ - 弱体化したレンガ）
//   4 = #ea580c（オレンジ - 損傷ハイライト）
//   5 = #6b7280（灰色 - 大きなひび割れ線）
// ---------------------------------------------------------------------------

/** 破壊可能壁・損傷のパレット */
const BREAKABLE_DAMAGED_PALETTE = ['', '#78350f', '#92400e', '#c2410c', '#ea580c', '#6b7280'];

/** 破壊可能壁・損傷のピクセルデータ（16×16） - 大きなひび割れ + 欠けたレンガ */
const BREAKABLE_DAMAGED_PIXELS: number[][] = [
  // y=0:  目地ライン（上端）- 一部崩れ
  [1, 1, 1, 1, 1, 5, 5, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  // y=1:  レンガ行 A - ひび割れ拡大
  [4, 3, 3, 2, 5, 5, 3, 1, 4, 3, 3, 2, 2, 2, 3, 1],
  // y=2:  ひび割れが斜めに走る
  [3, 3, 2, 5, 5, 2, 2, 1, 3, 3, 2, 2, 5, 2, 2, 1],
  // y=3:  レンガ欠損
  [3, 2, 5, 5, 2, 2, 2, 1, 3, 2, 2, 5, 5, 2, 2, 1],
  // y=4:  目地ライン - ひび割れ貫通
  [1, 5, 5, 1, 1, 1, 1, 1, 1, 1, 5, 5, 1, 1, 1, 1],
  // y=5:  レンガ行 B - 損傷激しい
  [2, 2, 3, 1, 4, 3, 3, 2, 2, 5, 5, 1, 4, 3, 3, 2],
  // y=6:  大きなひび割れ
  [2, 2, 2, 1, 3, 3, 5, 5, 5, 5, 2, 1, 3, 3, 2, 2],
  // y=7:  レンガ一部欠損（穴）
  [2, 2, 2, 1, 3, 5, 5, 0, 0, 5, 2, 1, 3, 2, 2, 2],
  // y=8:  目地ライン - 不規則
  [1, 1, 1, 1, 1, 5, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
  // y=9:  レンガ行 C - ひび割れ多数
  [4, 3, 3, 2, 5, 2, 3, 1, 4, 3, 5, 2, 2, 2, 3, 1],
  // y=10: 斜めひび割れ
  [3, 3, 2, 5, 5, 2, 2, 1, 3, 5, 5, 2, 2, 2, 2, 1],
  // y=11
  [3, 2, 5, 5, 2, 2, 2, 1, 5, 5, 2, 2, 2, 2, 2, 1],
  // y=12: 目地ライン - 崩壊箇所あり
  [1, 5, 5, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 5, 1, 1],
  // y=13: レンガ行 D - 損傷
  [2, 2, 3, 1, 4, 3, 5, 5, 2, 2, 3, 1, 4, 5, 3, 2],
  // y=14: ひび割れ
  [2, 2, 2, 1, 3, 5, 5, 2, 2, 2, 2, 1, 5, 5, 2, 2],
  // y=15: 下端 - 一部崩れ
  [2, 2, 2, 1, 5, 5, 2, 2, 2, 2, 2, 5, 5, 2, 2, 2],
];

/**
 * 破壊可能壁・損傷スプライト
 *
 * 大きなひび割れと欠損が目立つ壁。オレンジ色のトーンが
 * 弱体化を示し、一部にレンガの穴が見える。
 * あと一撃で崩壊しそうな状態を表現。
 */
export const BREAKABLE_DAMAGED_SPRITE: SpriteDefinition = {
  width: 16,
  height: 16,
  pixels: BREAKABLE_DAMAGED_PIXELS,
  palette: BREAKABLE_DAMAGED_PALETTE,
};

// ---------------------------------------------------------------------------
// 破壊可能壁・崩壊（Breakable Wall - Broken）
// ---------------------------------------------------------------------------
// パレット:
//   0 = 透明
//   1 = #065f46（暗い緑 - 通路の縁）
//   2 = #10b981（緑 - 通路のベース色）
//   3 = #34d399（明るい緑 - 通路のハイライト）
//   4 = #1f2937（暗い床色 - 中央の通路床）
//   5 = #78350f（暗い茶色 - 瓦礫）
// ---------------------------------------------------------------------------

/** 破壊可能壁・崩壊のパレット */
const BREAKABLE_BROKEN_PALETTE = ['', '#065f46', '#10b981', '#34d399', '#1f2937', '#78350f'];

/** 破壊可能壁・崩壊のピクセルデータ（16×16） - 瓦礫 + 通路 */
const BREAKABLE_BROKEN_PIXELS: number[][] = [
  // y=0:  上端 - 左右に瓦礫、中央は開口
  [5, 5, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5],
  // y=1:  瓦礫の山（左右）+ 通路
  [5, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5],
  // y=2:  瓦礫が減少、通路が広がる
  [5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 5],
  // y=3:  瓦礫の縁 + 床
  [5, 1, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 1, 5],
  // y=4:  通路の床が見える
  [1, 1, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 1, 1],
  // y=5:  緑の縁取り + 暗い床
  [1, 0, 0, 4, 4, 3, 4, 4, 4, 4, 3, 4, 4, 0, 0, 1],
  // y=6:  通路（完全に開いている）
  [0, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0],
  // y=7:  通路中央
  [0, 0, 4, 4, 4, 4, 3, 4, 4, 3, 4, 4, 4, 4, 0, 0],
  // y=8:  通路中央
  [0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0],
  // y=9:  通路（完全に開いている）
  [0, 0, 0, 4, 4, 3, 4, 4, 4, 4, 3, 4, 4, 0, 0, 0],
  // y=10: 緑の縁取り + 暗い床
  [1, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 1],
  // y=11: 通路の床
  [1, 1, 0, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 1, 1],
  // y=12: 瓦礫の縁 + 床
  [5, 1, 0, 0, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 1, 5],
  // y=13: 瓦礫が増加
  [5, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 5],
  // y=14: 瓦礫の山（左右）
  [5, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5],
  // y=15: 下端 - 左右に瓦礫
  [5, 5, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 5, 5],
];

/**
 * 破壊可能壁・崩壊スプライト
 *
 * 壁が完全に崩壊し、通路が開通した状態。
 * 中央に暗い床が見え、左右に茶色の瓦礫が残る。
 * 緑の縁取りが通過可能であることを視覚的に示す。
 */
export const BREAKABLE_BROKEN_SPRITE: SpriteDefinition = {
  width: 16,
  height: 16,
  pixels: BREAKABLE_BROKEN_PIXELS,
  palette: BREAKABLE_BROKEN_PALETTE,
};

// ---------------------------------------------------------------------------
// 通過可能壁（Passable Wall）
// ---------------------------------------------------------------------------
// パレット:
//   0 = 透明
//   1 = #374151（暗い灰色 - 目地・輪郭）
//   2 = #4b5563（中間灰色 - レンガのベース色）
//   3 = #6b7280（灰色 - レンガの明るい面）
//   4 = #9ca3af（明るい灰色 - ハイライト）
// ---------------------------------------------------------------------------

/** 通過可能壁のパレット */
const PASSABLE_WALL_PALETTE = ['', '#374151', '#4b5563', '#6b7280', '#9ca3af'];

/**
 * 通過可能壁のピクセルデータ（16×16） - 点線パターン
 * 通常の壁と同じ構造だが、1ピクセルおきに透明にすることで
 * 半透明の見た目を表現する。
 */
const PASSABLE_WALL_PIXELS: number[][] = [
  // y=0:  目地ライン（点線）
  [1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0],
  // y=1:  レンガ行 A（透かしパターン）
  [0, 3, 0, 2, 0, 2, 0, 1, 0, 3, 0, 2, 0, 2, 0, 1],
  // y=2
  [3, 0, 2, 0, 2, 0, 2, 0, 3, 0, 2, 0, 2, 0, 2, 0],
  // y=3
  [0, 2, 0, 2, 0, 2, 0, 1, 0, 2, 0, 2, 0, 2, 0, 1],
  // y=4:  目地ライン（点線）
  [0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1],
  // y=5:  レンガ行 B（オフセット + 透かし）
  [2, 0, 3, 0, 4, 0, 3, 0, 2, 0, 3, 0, 4, 0, 3, 0],
  // y=6
  [0, 2, 0, 1, 0, 3, 0, 2, 0, 2, 0, 1, 0, 3, 0, 2],
  // y=7
  [2, 0, 2, 0, 3, 0, 2, 0, 2, 0, 2, 0, 3, 0, 2, 0],
  // y=8:  目地ライン（点線）
  [1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0],
  // y=9:  レンガ行 C（行 A と同パターン）
  [0, 3, 0, 2, 0, 2, 0, 1, 0, 3, 0, 2, 0, 2, 0, 1],
  // y=10
  [3, 0, 2, 0, 2, 0, 2, 0, 3, 0, 2, 0, 2, 0, 2, 0],
  // y=11
  [0, 2, 0, 2, 0, 2, 0, 1, 0, 2, 0, 2, 0, 2, 0, 1],
  // y=12: 目地ライン（点線）
  [0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1],
  // y=13: レンガ行 D（行 B と同パターン）
  [2, 0, 3, 0, 4, 0, 3, 0, 2, 0, 3, 0, 4, 0, 3, 0],
  // y=14
  [0, 2, 0, 1, 0, 3, 0, 2, 0, 2, 0, 1, 0, 3, 0, 2],
  // y=15
  [2, 0, 2, 0, 3, 0, 2, 0, 2, 0, 2, 0, 3, 0, 2, 0],
];

/**
 * 通過可能壁スプライト
 *
 * 半透明に見えるレンガ壁。通常の壁と同じ構造を持つが、
 * 市松模様のように1ピクセルおきに透明にすることで
 * 「すり抜けられる」ことを視覚的に表現する。
 */
export const PASSABLE_WALL_SPRITE: SpriteDefinition = {
  width: 16,
  height: 16,
  pixels: PASSABLE_WALL_PIXELS,
  palette: PASSABLE_WALL_PALETTE,
};

// ---------------------------------------------------------------------------
// 不可視壁（Invisible Wall）
// ---------------------------------------------------------------------------
// パレット:
//   0 = 透明
//   1 = #4c1d95（最も暗い紫 - 外縁・影）
//   2 = #6b21a8（暗い紫 - ベース色）
//   3 = #7c3aed（紫 - メインカラー）
//   4 = #a78bfa（明るい紫 - 光るエッジ・ハイライト）
// ---------------------------------------------------------------------------

/** 不可視壁のパレット */
const INVISIBLE_WALL_PALETTE = ['', '#4c1d95', '#6b21a8', '#7c3aed', '#a78bfa'];

/**
 * 不可視壁のピクセルデータ（16×16） - 紫のオーラを纏った壁
 * 太い紫の輪郭線と密な紫のフィルで神秘的な外観を表現。
 * 光るエッジが魔法的な見た目を強調する。
 */
const INVISIBLE_WALL_PIXELS: number[][] = [
  // y=0:  太い上端輪郭（光るエッジ）
  [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
  // y=1:  光るエッジ + 紫フィル
  [4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4],
  // y=2:  外縁 + 内部紫フィル
  [4, 3, 2, 2, 3, 2, 2, 3, 3, 2, 2, 3, 2, 2, 3, 4],
  // y=3:  密な紫フィル
  [4, 3, 2, 3, 3, 3, 2, 2, 2, 2, 3, 3, 3, 2, 3, 4],
  // y=4:  光る模様（中心に向かう）
  [4, 3, 3, 3, 2, 2, 3, 3, 3, 3, 2, 2, 3, 3, 3, 4],
  // y=5:  紫フィル + 内側の光
  [4, 3, 2, 2, 2, 3, 3, 4, 4, 3, 3, 2, 2, 2, 3, 4],
  // y=6:  中央付近（光が強い）
  [4, 3, 2, 3, 3, 3, 4, 3, 3, 4, 3, 3, 3, 2, 3, 4],
  // y=7:  中央行（最も明るい部分）
  [4, 3, 3, 2, 3, 4, 3, 3, 3, 3, 4, 3, 2, 3, 3, 4],
  // y=8:  中央行（対称）
  [4, 3, 3, 2, 3, 4, 3, 3, 3, 3, 4, 3, 2, 3, 3, 4],
  // y=9:  中央付近（光が強い）
  [4, 3, 2, 3, 3, 3, 4, 3, 3, 4, 3, 3, 3, 2, 3, 4],
  // y=10: 紫フィル + 内側の光
  [4, 3, 2, 2, 2, 3, 3, 4, 4, 3, 3, 2, 2, 2, 3, 4],
  // y=11: 光る模様（中心から離れる）
  [4, 3, 3, 3, 2, 2, 3, 3, 3, 3, 2, 2, 3, 3, 3, 4],
  // y=12: 密な紫フィル
  [4, 3, 2, 3, 3, 3, 2, 2, 2, 2, 3, 3, 3, 2, 3, 4],
  // y=13: 外縁 + 内部紫フィル
  [4, 3, 2, 2, 3, 2, 2, 3, 3, 2, 2, 3, 2, 2, 3, 4],
  // y=14: 光るエッジ + 紫フィル
  [4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4],
  // y=15: 太い下端輪郭（光るエッジ）
  [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4],
];

/**
 * 不可視壁スプライト
 *
 * 紫色のオーラを纏った魔法的な壁。太い紫の輪郭線に囲まれ、
 * 中心に向かって光が集まるデザイン。見た目は確かに存在するが、
 * 神秘的な雰囲気で「普通の壁ではない」ことを暗示する。
 */
export const INVISIBLE_WALL_SPRITE: SpriteDefinition = {
  width: 16,
  height: 16,
  pixels: INVISIBLE_WALL_PIXELS,
  palette: INVISIBLE_WALL_PALETTE,
};

// ---------------------------------------------------------------------------
// ヘルパー関数
// ---------------------------------------------------------------------------

/**
 * 壁タイプと状態からスプライトを取得するヘルパー関数
 *
 * @param wallType - 壁タイプ（'breakable' | 'passable' | 'invisible'）
 * @param state - 壁の状態（破壊可能壁の場合: 'intact' | 'damaged' | 'broken'）
 * @returns 対応する SpriteDefinition
 * @throws 不明な壁タイプまたは状態が指定された場合にエラーをスロー
 */
export function getWallSprite(wallType: string, state?: string): SpriteDefinition {
  switch (wallType) {
    case 'breakable': {
      // 破壊可能壁は状態に応じて異なるスプライトを返す
      const breakableState = state ?? 'intact';
      switch (breakableState) {
        case 'intact':
          return BREAKABLE_INTACT_SPRITE;
        case 'damaged':
          return BREAKABLE_DAMAGED_SPRITE;
        case 'broken':
          return BREAKABLE_BROKEN_SPRITE;
        default:
          throw new Error(`不明な破壊可能壁の状態: ${breakableState}`);
      }
    }
    case 'passable':
      return PASSABLE_WALL_SPRITE;
    case 'invisible':
      return INVISIBLE_WALL_SPRITE;
    default:
      throw new Error(`不明な壁タイプ: ${wallType}`);
  }
}
