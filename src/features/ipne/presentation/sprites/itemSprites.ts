/**
 * アイテムスプライト定義
 *
 * ゲーム内アイテム（ポーション、星、巻物、鍵）の
 * 8x8 ピクセルアートスプライトを定義する。
 */

import { SpriteDefinition } from './spriteData';
import { SpriteSheetDefinition } from './spriteSheet';

// ============================================================
// 1. 小回復ポーション (Health Potion Small)
// ============================================================
/**
 * 小回復ポーション - 緑色の小さなフラスコ
 *
 * パレット:
 *   0 = 透明
 *   1 = ダークグリーン (#065f46)
 *   2 = グリーン (#10b981)
 *   3 = ライトグリーン (#34d399)
 *   4 = 最も明るいグリーン (#6ee7b7)
 */
export const HEALTH_SMALL_SPRITE: SpriteDefinition = {
  width: 8,
  height: 8,
  palette: ['', '#065f46', '#10b981', '#34d399', '#6ee7b7'],
  pixels: [
    // y=0: フラスコの栓
    [0, 0, 0, 3, 3, 0, 0, 0],
    // y=1: 首の部分
    [0, 0, 0, 1, 1, 0, 0, 0],
    // y=2: 首から胴体への遷移
    [0, 0, 1, 2, 2, 1, 0, 0],
    // y=3: 胴体上部（液体の上面）
    [0, 0, 1, 3, 4, 1, 0, 0],
    // y=4: 胴体中部（液体）
    [0, 1, 2, 3, 3, 2, 1, 0],
    // y=5: 胴体中部（液体）
    [0, 1, 2, 2, 3, 2, 1, 0],
    // y=6: 胴体下部（液体）
    [0, 1, 1, 2, 2, 1, 1, 0],
    // y=7: 底面
    [0, 0, 1, 1, 1, 1, 0, 0],
  ],
};

// ============================================================
// 2. 大回復ポーション (Health Potion Large)
// ============================================================
/**
 * 大回復ポーション - 赤色の丸みのあるボトル
 *
 * パレット:
 *   0 = 透明
 *   1 = ダークレッド (#991b1b)
 *   2 = レッド (#dc2626)
 *   3 = ライトレッド (#f87171)
 *   4 = 最も明るいレッド (#fca5a5)
 */
export const HEALTH_LARGE_SPRITE: SpriteDefinition = {
  width: 8,
  height: 8,
  palette: ['', '#991b1b', '#dc2626', '#f87171', '#fca5a5'],
  pixels: [
    // y=0: ボトルの栓
    [0, 0, 0, 3, 3, 0, 0, 0],
    // y=1: 首の部分
    [0, 0, 1, 2, 2, 1, 0, 0],
    // y=2: 胴体上部（広がり始め）
    [0, 1, 2, 3, 4, 2, 1, 0],
    // y=3: 胴体中部（最大幅）
    [1, 2, 3, 4, 4, 3, 2, 1],
    // y=4: 胴体中部（液体）
    [1, 2, 2, 3, 3, 2, 2, 1],
    // y=5: 胴体中部（液体）
    [1, 2, 2, 3, 3, 2, 2, 1],
    // y=6: 胴体下部（すぼまり）
    [0, 1, 2, 2, 2, 2, 1, 0],
    // y=7: 底面
    [0, 0, 1, 1, 1, 1, 0, 0],
  ],
};

// ============================================================
// 3. 完全回復ポーション (Health Full) - 2フレームアニメーション
// ============================================================
/**
 * 完全回復ポーション - 金色の装飾ボトル（キラキラ演出）
 *
 * パレット:
 *   0 = 透明
 *   1 = ダークゴールド (#92400e)
 *   2 = ゴールド (#d97706)
 *   3 = ライトゴールド (#fbbf24)
 *   4 = 最も明るいゴールド/白 (#fef3c7)
 */
const healthFullFrame1: SpriteDefinition = {
  width: 8,
  height: 8,
  palette: ['', '#92400e', '#d97706', '#fbbf24', '#fef3c7'],
  pixels: [
    // y=0: 装飾付きの栓
    [0, 0, 0, 4, 4, 0, 0, 0],
    // y=1: 首部分（装飾リング）
    [0, 0, 1, 3, 3, 1, 0, 0],
    // y=2: 胴体上部
    [0, 1, 2, 3, 4, 2, 1, 0],
    // y=3: 胴体中部（最大幅）
    [1, 2, 3, 4, 4, 3, 2, 1],
    // y=4: 胴体中部（液体）
    [1, 2, 3, 3, 4, 3, 2, 1],
    // y=5: 胴体中部（液体）
    [1, 2, 2, 3, 3, 2, 2, 1],
    // y=6: 胴体下部
    [0, 1, 2, 2, 2, 2, 1, 0],
    // y=7: 底面
    [0, 0, 1, 1, 1, 1, 0, 0],
  ],
};

/** フレーム2: キラキラエフェクト（一部ピクセルが明るく変化） */
const healthFullFrame2: SpriteDefinition = {
  width: 8,
  height: 8,
  palette: ['', '#92400e', '#d97706', '#fbbf24', '#fef3c7'],
  pixels: [
    // y=0: 栓の上にきらめき
    [0, 0, 4, 4, 4, 4, 0, 0],
    // y=1: 首部分
    [0, 0, 1, 4, 4, 1, 0, 0],
    // y=2: 胴体上部（ハイライト強化）
    [0, 1, 3, 4, 4, 3, 1, 0],
    // y=3: 胴体中部（きらめき追加）
    [1, 3, 4, 4, 4, 4, 3, 1],
    // y=4: 胴体中部
    [1, 2, 3, 4, 4, 3, 2, 1],
    // y=5: 胴体中部
    [1, 2, 3, 3, 3, 3, 2, 1],
    // y=6: 胴体下部
    [0, 1, 2, 3, 3, 2, 1, 0],
    // y=7: 底面
    [0, 0, 1, 1, 1, 1, 0, 0],
  ],
};

/** 完全回復ポーション スプライトシート（300ms間隔でキラキラ） */
export const HEALTH_FULL_SPRITE_SHEET: SpriteSheetDefinition = {
  sprites: [healthFullFrame1, healthFullFrame2],
  frameDuration: 300,
};

// ============================================================
// 4. レベルアップ星 (Level Up Star) - 2フレームアニメーション
// ============================================================
/**
 * レベルアップ星 - ピンク色の5角星（点滅演出）
 *
 * パレット:
 *   0 = 透明
 *   1 = ダークピンク (#831843)
 *   2 = ピンク (#db2777)
 *   3 = ライトピンク (#f472b6)
 *   4 = 最も明るいピンク (#fbcfe8)
 */
const levelUpFrame1: SpriteDefinition = {
  width: 8,
  height: 8,
  palette: ['', '#831843', '#db2777', '#f472b6', '#fbcfe8'],
  pixels: [
    // y=0: 星の上端
    [0, 0, 0, 3, 3, 0, 0, 0],
    // y=1: 星の上部
    [0, 0, 1, 2, 2, 1, 0, 0],
    // y=2: 星の腕（横方向に広がる）
    [1, 1, 2, 3, 3, 2, 1, 1],
    // y=3: 星の中央帯（最大幅）
    [0, 1, 2, 3, 3, 2, 1, 0],
    // y=4: 星の下部中央
    [0, 0, 1, 2, 2, 1, 0, 0],
    // y=5: 星の下側の二股
    [0, 1, 2, 1, 1, 2, 1, 0],
    // y=6: 二股の先端
    [1, 2, 1, 0, 0, 1, 2, 1],
    // y=7: 二股の最先端
    [1, 1, 0, 0, 0, 0, 1, 1],
  ],
};

/** フレーム2: 明るく点滅（全体的にパレットインデックスが1段階上がる） */
const levelUpFrame2: SpriteDefinition = {
  width: 8,
  height: 8,
  palette: ['', '#831843', '#db2777', '#f472b6', '#fbcfe8'],
  pixels: [
    // y=0: 星の上端（明るく）
    [0, 0, 0, 4, 4, 0, 0, 0],
    // y=1: 星の上部（明るく）
    [0, 0, 2, 3, 3, 2, 0, 0],
    // y=2: 星の腕（明るく）
    [2, 2, 3, 4, 4, 3, 2, 2],
    // y=3: 星の中央帯（明るく）
    [0, 2, 3, 4, 4, 3, 2, 0],
    // y=4: 星の下部中央（明るく）
    [0, 0, 2, 3, 3, 2, 0, 0],
    // y=5: 星の下側の二股（明るく）
    [0, 2, 3, 2, 2, 3, 2, 0],
    // y=6: 二股の先端（明るく）
    [2, 3, 2, 0, 0, 2, 3, 2],
    // y=7: 二股の最先端（明るく）
    [2, 2, 0, 0, 0, 0, 2, 2],
  ],
};

/** レベルアップ星 スプライトシート（400ms間隔で点滅） */
export const LEVEL_UP_SPRITE_SHEET: SpriteSheetDefinition = {
  sprites: [levelUpFrame1, levelUpFrame2],
  frameDuration: 400,
};

// ============================================================
// 5. 地図巻物 (Map Reveal Scroll)
// ============================================================
/**
 * 地図巻物 - 巻かれた羊皮紙の巻物
 *
 * パレット:
 *   0 = 透明
 *   1 = ダークブラウン (#78350f)
 *   2 = ブラウン (#a16207)
 *   3 = ライトブラウン (#d4a574)
 *   4 = 羊皮紙色 (#fef3c7)
 */
export const MAP_REVEAL_SPRITE: SpriteDefinition = {
  width: 8,
  height: 8,
  palette: ['', '#78350f', '#a16207', '#d4a574', '#fef3c7'],
  pixels: [
    // y=0: 巻物の上部ロール
    [0, 0, 1, 2, 2, 2, 1, 0],
    // y=1: ロール部分（丸み表現）
    [0, 1, 3, 4, 4, 3, 2, 1],
    // y=2: 紙面上部
    [0, 1, 4, 4, 4, 4, 1, 0],
    // y=3: 紙面中部（文字を示す模様）
    [0, 1, 4, 3, 3, 4, 1, 0],
    // y=4: 紙面中部（文字を示す模様）
    [0, 1, 4, 4, 3, 4, 1, 0],
    // y=5: 紙面下部（文字を示す模様）
    [0, 1, 4, 3, 4, 3, 1, 0],
    // y=6: ロール部分（下部の丸み）
    [0, 1, 3, 4, 4, 3, 2, 1],
    // y=7: 巻物の下部ロール
    [0, 0, 1, 2, 2, 2, 1, 0],
  ],
};

// ============================================================
// 6. 鍵 (Key) - 2フレームアニメーション
// ============================================================
/**
 * 鍵 - 金色のクラシックな鍵（キラキラ演出）
 *
 * パレット:
 *   0 = 透明
 *   1 = ダークゴールド (#92400e)
 *   2 = ゴールド (#d97706)
 *   3 = ライトゴールド (#fbbf24)
 *   4 = 白いきらめき (#fef3c7)
 */
const keyFrame1: SpriteDefinition = {
  width: 8,
  height: 8,
  palette: ['', '#92400e', '#d97706', '#fbbf24', '#fef3c7'],
  pixels: [
    // y=0: 鍵の持ち手（弓）上部
    [0, 0, 1, 2, 2, 1, 0, 0],
    // y=1: 弓の中空部分
    [0, 1, 3, 0, 0, 3, 1, 0],
    // y=2: 弓の下部
    [0, 0, 1, 2, 2, 1, 0, 0],
    // y=3: シャフト（柄）開始
    [0, 0, 0, 1, 2, 0, 0, 0],
    // y=4: シャフト中部
    [0, 0, 0, 1, 2, 0, 0, 0],
    // y=5: シャフト（歯の始まり）
    [0, 0, 0, 1, 2, 3, 0, 0],
    // y=6: 歯の部分
    [0, 0, 0, 1, 2, 0, 0, 0],
    // y=7: 歯の先端
    [0, 0, 0, 1, 2, 3, 0, 0],
  ],
};

/** フレーム2: キラキラエフェクト（光沢が移動） */
const keyFrame2: SpriteDefinition = {
  width: 8,
  height: 8,
  palette: ['', '#92400e', '#d97706', '#fbbf24', '#fef3c7'],
  pixels: [
    // y=0: 弓の上部（ハイライト）
    [0, 0, 1, 3, 3, 1, 0, 0],
    // y=1: 弓の中空部分（きらめき追加）
    [0, 1, 4, 0, 0, 4, 1, 0],
    // y=2: 弓の下部（ハイライト）
    [0, 0, 1, 3, 3, 1, 0, 0],
    // y=3: シャフト（ハイライト）
    [0, 0, 0, 2, 3, 0, 0, 0],
    // y=4: シャフト中部（きらめき）
    [0, 0, 0, 2, 4, 0, 0, 0],
    // y=5: シャフト（歯の始まり、きらめき）
    [0, 0, 0, 2, 3, 4, 0, 0],
    // y=6: 歯の部分
    [0, 0, 0, 1, 3, 0, 0, 0],
    // y=7: 歯の先端（きらめき）
    [0, 0, 0, 2, 3, 4, 0, 0],
  ],
};

/** 鍵 スプライトシート（350ms間隔でキラキラ） */
export const KEY_SPRITE_SHEET: SpriteSheetDefinition = {
  sprites: [keyFrame1, keyFrame2],
  frameDuration: 350,
};

// ============================================================
// ヘルパー関数
// ============================================================

/**
 * アイテムタイプ文字列からスプライトまたはスプライトシートを取得する
 *
 * @param itemType - アイテムの種類を示す文字列
 * @returns 対応する SpriteDefinition または SpriteSheetDefinition
 * @throws アイテムタイプが不明な場合にエラーをスロー
 */
export function getItemSprite(
  itemType: string
): SpriteDefinition | SpriteSheetDefinition {
  switch (itemType) {
    case 'healthSmall':
      return HEALTH_SMALL_SPRITE;
    case 'healthLarge':
      return HEALTH_LARGE_SPRITE;
    case 'healthFull':
      return HEALTH_FULL_SPRITE_SHEET;
    case 'levelUp':
      return LEVEL_UP_SPRITE_SHEET;
    case 'mapReveal':
      return MAP_REVEAL_SPRITE;
    case 'key':
      return KEY_SPRITE_SHEET;
    default:
      throw new Error(`不明なアイテムタイプです: ${itemType}`);
  }
}
